package org.terifan.security;


/**
 * Class implementing a 64-bit checksum function. The algorithm to compute the
 * CRC is described in the CRC-64-ECMA-182 standard. The generator polynomial is
 * 	x64 + x62 + x57 + x55 + x54 + x53 + x52 + x47 + x46 + x45 + x40 +
 *  x39 + x38 + x37 + x35 + x33 + x32 + x31 + x29 + x27 + x24 + x23 +
 *  x22 + x21 + x19 + x17 + x13 + x12 + x10 +  x9 +  x7 +  x4 + x + 1.
 *
 * Verification: <code>digest("123456789".getBytes()) == 0x4773490B5FDF406CL</code>
 */
public class CRC64E
{
	public static long digest(byte[] aInput, int aOffset, int aLength)
	{
		long crc = 0L;

		for (int i = 0; i < aLength; i++)
		{
			crc = (crc >>> 8) ^ TABLE[(int)(aInput[aOffset + i] ^ crc) & 0xFF];
		}

		return crc;
	}


	private final static long[] TABLE =
	{
		0x0000000000000000L, 0x9336EAA9EBE1F042L, 0x266DD453D7C3E185L, 0xB55B3EFA3C2211C7L,
		0xDFEC420E45663349L, 0x4CDAA8A7AE87C30BL, 0xF981965D92A5D2CCL, 0x6AB77CF47944228EL,
		0xBED9851C8ACC6692L, 0x2DEF6FB5612D96D0L, 0x98B4514F5D0F8717L, 0x0B82BBE6B6EE7755L,
		0x6135C712CFAA55DBL, 0xF2032DBB244BA599L, 0x475813411869B45EL, 0xD46EF9E8F388441CL,
		0xEF85E190FF783D66L, 0x7CB30B391499CD24L, 0xC9E835C328BBDCE3L, 0x5ADEDF6AC35A2CA1L,
		0x3069A39EBA1E0E2FL, 0xA35F493751FFFE6DL, 0x160477CD6DDDEFAAL, 0x85329D64863C1FE8L,
		0x515C648C75B45BF4L, 0xC26A8E259E55ABB6L, 0x7731B0DFA277BA71L, 0xE4075A7649964A33L,
		0x8EB0268230D268BDL, 0x1D86CC2BDB3398FFL, 0xA8DDF2D1E7118938L, 0x3BEB18780CF0797AL,
		0xDE0BC321FFF17ACCL, 0x4D3D298814108A8EL, 0xF866177228329B49L, 0x6B50FDDBC3D36B0BL,
		0x01E7812FBA974985L, 0x92D16B865176B9C7L, 0x278A557C6D54A800L, 0xB4BCBFD586B55842L,
		0x60D2463D753D1C5EL, 0xF3E4AC949EDCEC1CL, 0x46BF926EA2FEFDDBL, 0xD58978C7491F0D99L,
		0xBF3E0433305B2F17L, 0x2C08EE9ADBBADF55L, 0x9953D060E798CE92L, 0x0A653AC90C793ED0L,
		0x318E22B1008947AAL, 0xA2B8C818EB68B7E8L, 0x17E3F6E2D74AA62FL, 0x84D51C4B3CAB566DL,
		0xEE6260BF45EF74E3L, 0x7D548A16AE0E84A1L, 0xC80FB4EC922C9566L, 0x5B395E4579CD6524L,
		0x8F57A7AD8A452138L, 0x1C614D0461A4D17AL, 0xA93A73FE5D86C0BDL, 0x3A0C9957B66730FFL,
		0x50BBE5A3CF231271L, 0xC38D0F0A24C2E233L, 0x76D631F018E0F3F4L, 0xE5E0DB59F30103B6L,
		0x2F216CEA150205DAL, 0xBC178643FEE3F598L, 0x094CB8B9C2C1E45FL, 0x9A7A52102920141DL,
		0xF0CD2EE450643693L, 0x63FBC44DBB85C6D1L, 0xD6A0FAB787A7D716L, 0x4596101E6C462754L,
		0x91F8E9F69FCE6348L, 0x02CE035F742F930AL, 0xB7953DA5480D82CDL, 0x24A3D70CA3EC728FL,
		0x4E14ABF8DAA85001L, 0xDD2241513149A043L, 0x68797FAB0D6BB184L, 0xFB4F9502E68A41C6L,
		0xC0A48D7AEA7A38BCL, 0x539267D3019BC8FEL, 0xE6C959293DB9D939L, 0x75FFB380D658297BL,
		0x1F48CF74AF1C0BF5L, 0x8C7E25DD44FDFBB7L, 0x39251B2778DFEA70L, 0xAA13F18E933E1A32L,
		0x7E7D086660B65E2EL, 0xED4BE2CF8B57AE6CL, 0x5810DC35B775BFABL, 0xCB26369C5C944FE9L,
		0xA1914A6825D06D67L, 0x32A7A0C1CE319D25L, 0x87FC9E3BF2138CE2L, 0x14CA749219F27CA0L,
		0xF12AAFCBEAF37F16L, 0x621C456201128F54L, 0xD7477B983D309E93L, 0x44719131D6D16ED1L,
		0x2EC6EDC5AF954C5FL, 0xBDF0076C4474BC1DL, 0x08AB39967856ADDAL, 0x9B9DD33F93B75D98L,
		0x4FF32AD7603F1984L, 0xDCC5C07E8BDEE9C6L, 0x699EFE84B7FCF801L, 0xFAA8142D5C1D0843L,
		0x901F68D925592ACDL, 0x03298270CEB8DA8FL, 0xB672BC8AF29ACB48L, 0x25445623197B3B0AL,
		0x1EAF4E5B158B4270L, 0x8D99A4F2FE6AB232L, 0x38C29A08C248A3F5L, 0xABF470A129A953B7L,
		0xC1430C5550ED7139L, 0x5275E6FCBB0C817BL, 0xE72ED806872E90BCL, 0x741832AF6CCF60FEL,
		0xA076CB479F4724E2L, 0x334021EE74A6D4A0L, 0x861B1F144884C567L, 0x152DF5BDA3653525L,
		0x7F9A8949DA2117ABL, 0xECAC63E031C0E7E9L, 0x59F75D1A0DE2F62EL, 0xCAC1B7B3E603066CL,
		0xCD74327DC0E5FAF6L, 0x5E42D8D42B040AB4L, 0xEB19E62E17261B73L, 0x782F0C87FCC7EB31L,
		0x129870738583C9BFL, 0x81AE9ADA6E6239FDL, 0x34F5A4205240283AL, 0xA7C34E89B9A1D878L,
		0x73ADB7614A299C64L, 0xE09B5DC8A1C86C26L, 0x55C063329DEA7DE1L, 0xC6F6899B760B8DA3L,
		0xAC41F56F0F4FAF2DL, 0x3F771FC6E4AE5F6FL, 0x8A2C213CD88C4EA8L, 0x191ACB95336DBEEAL,
		0x22F1D3ED3F9DC790L, 0xB1C73944D47C37D2L, 0x049C07BEE85E2615L, 0x97AAED1703BFD657L,
		0xFD1D91E37AFBF4D9L, 0x6E2B7B4A911A049BL, 0xDB7045B0AD38155CL, 0x4846AF1946D9E51EL,
		0x9C2856F1B551A102L, 0x0F1EBC585EB05140L, 0xBA4582A262924087L, 0x2973680B8973B0C5L,
		0x43C414FFF037924BL, 0xD0F2FE561BD66209L, 0x65A9C0AC27F473CEL, 0xF69F2A05CC15838CL,
		0x137FF15C3F14803AL, 0x80491BF5D4F57078L, 0x3512250FE8D761BFL, 0xA624CFA6033691FDL,
		0xCC93B3527A72B373L, 0x5FA559FB91934331L, 0xEAFE6701ADB152F6L, 0x79C88DA84650A2B4L,
		0xADA67440B5D8E6A8L, 0x3E909EE95E3916EAL, 0x8BCBA013621B072DL, 0x18FD4ABA89FAF76FL,
		0x724A364EF0BED5E1L, 0xE17CDCE71B5F25A3L, 0x5427E21D277D3464L, 0xC71108B4CC9CC426L,
		0xFCFA10CCC06CBD5CL, 0x6FCCFA652B8D4D1EL, 0xDA97C49F17AF5CD9L, 0x49A12E36FC4EAC9BL,
		0x231652C2850A8E15L, 0xB020B86B6EEB7E57L, 0x057B869152C96F90L, 0x964D6C38B9289FD2L,
		0x422395D04AA0DBCEL, 0xD1157F79A1412B8CL, 0x644E41839D633A4BL, 0xF778AB2A7682CA09L,
		0x9DCFD7DE0FC6E887L, 0x0EF93D77E42718C5L, 0xBBA2038DD8050902L, 0x2894E92433E4F940L,
		0xE2555E97D5E7FF2CL, 0x7163B43E3E060F6EL, 0xC4388AC402241EA9L, 0x570E606DE9C5EEEBL,
		0x3DB91C999081CC65L, 0xAE8FF6307B603C27L, 0x1BD4C8CA47422DE0L, 0x88E22263ACA3DDA2L,
		0x5C8CDB8B5F2B99BEL, 0xCFBA3122B4CA69FCL, 0x7AE10FD888E8783BL, 0xE9D7E57163098879L,
		0x836099851A4DAAF7L, 0x1056732CF1AC5AB5L, 0xA50D4DD6CD8E4B72L, 0x363BA77F266FBB30L,
		0x0DD0BF072A9FC24AL, 0x9EE655AEC17E3208L, 0x2BBD6B54FD5C23CFL, 0xB88B81FD16BDD38DL,
		0xD23CFD096FF9F103L, 0x410A17A084180141L, 0xF451295AB83A1086L, 0x6767C3F353DBE0C4L,
		0xB3093A1BA053A4D8L, 0x203FD0B24BB2549AL, 0x9564EE487790455DL, 0x065204E19C71B51FL,
		0x6CE57815E5359791L, 0xFFD392BC0ED467D3L, 0x4A88AC4632F67614L, 0xD9BE46EFD9178656L,
		0x3C5E9DB62A1685E0L, 0xAF68771FC1F775A2L, 0x1A3349E5FDD56465L, 0x8905A34C16349427L,
		0xE3B2DFB86F70B6A9L, 0x70843511849146EBL, 0xC5DF0BEBB8B3572CL, 0x56E9E1425352A76EL,
		0x828718AAA0DAE372L, 0x11B1F2034B3B1330L, 0xA4EACCF9771902F7L, 0x37DC26509CF8F2B5L,
		0x5D6B5AA4E5BCD03BL, 0xCE5DB00D0E5D2079L, 0x7B068EF7327F31BEL, 0xE830645ED99EC1FCL,
		0xD3DB7C26D56EB886L, 0x40ED968F3E8F48C4L, 0xF5B6A87502AD5903L, 0x668042DCE94CA941L,
		0x0C373E2890088BCFL, 0x9F01D4817BE97B8DL, 0x2A5AEA7B47CB6A4AL, 0xB96C00D2AC2A9A08L,
		0x6D02F93A5FA2DE14L, 0xFE341393B4432E56L, 0x4B6F2D6988613F91L, 0xD859C7C06380CFD3L,
		0xB2EEBB341AC4ED5DL, 0x21D8519DF1251D1FL, 0x94836F67CD070CD8L, 0x07B585CE26E6FC9AL
	};
}
